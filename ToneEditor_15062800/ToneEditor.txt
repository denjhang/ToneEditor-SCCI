ToneEditor(仮) Version 0.0b Edition について

 諸星圭(Kei Moroboshi) 2015/06/28

●はじめに
このソフトウエアは、FM音源の音色を編集するためのソフトウエアです。
元々はサンプル用として作成したものであるため、凝った作りとはなっており
ません。
既存の公開された音色を入力して気軽に試す等のために作成されています。
古来行われた「音色作り」の楽しさを思い出していただければ幸いです。

次の実FM音源チップを搭載したハードウエアに対応しています。

・G.I.M.I.C 
　Project GIMIC( http://gimic.jp ) によるハードウエアです。
・RE:Birth
　Project RE:birth( http://ym2203.com/rebirth/ ) によるハードウエアです。
・SPFM(FMの塔)
　http://www.pyonpyon.jp/~fmtower/index.html によるハードウエアです。

#なお、honet氏によるハードウエアC86BOXも動作する可能性があります(ハード
#ウエアは入手済みですが動作確認は出来ておりません)。


●インストール方法
・Visual C++ランタイムのインストール
Visual Studio 2013 の Visual C++ランタイムが別途必要です。
未インストールの場合は必ず事前にインストール
http://www.microsoft.com/ja-jp/download/details.aspx?id=40784

・本ソフトウエアのインストール
添付のファイルを任意のディレクトリに解凍してください。

・GIMIC 用制御ソフトウエア(c86ctl)のインストール
GIMICをご利用の場合は、
http://gimic.jp/index.php?USB%E5%88%B6%E5%BE%A1%E3%83%A2%E3%83%BC%E3%83%89
を参照し、"c86ctl" を入手のうえ、展開されたc86ctl.dll を本ソフト
ウエアと同じディレクトリにコピーしてください。


・RE:birthまたはSPFM(FMの塔)用制御ソフトウエア(scci)のインストールと設定
RE:birthまたはFMの塔のいずれか、あるいは両方をご利用の場合は
http://www.pyonpyon.jp/~gasshi/fm/
より制御用ソフトウエア SCCI を入手のうえ、展開された scci.dll および
scciconfig.exeを本ソフトウエアと同じディレクトリにコピーしてください。
次にRE:birthまたはFMの塔を接続し、scciconfig.exe を起動して音源モ
ジュールの設定を事前に行っておいてください。
#SCCIを使用する場合必ずハードウエアを準備しておいてください。
#何もハードウエアが接続されていない状態ではクラッシュしますのでSCCI.DLL
#をリネームするなどしておいてください。
#"SCCI 2015/6/21版(以前含む)"でのクラッシュを確認しています。
#SCCI側はフィードバックしていますが、現状では制限事項となります。

なお、使用するハードウエアに対応する制御ソフトウエアのインストール
のみで問題ありません。
つまりGIMICしか使用しない(RE:birthは所有していない)のであれば、
GIMIC用のc86ctl.dllのみをコピーしてください(使用しないRE:birthまたは
FMの塔用のscci.dllはコピーする必要はありません)。
両方をインストールした場合は、c86ctl.dll側を先に確認します。

・X68Sound.dllのインストール(オプションで必須ではありません)
ソフトウエアでOPMを模倣するX68Sound.dllに対応しています。
GIMICやSPFM/RE:birthの実FM音源チップハードウエアが無い(利用できない)
環境でも、ソフトウエアだけでOPM用の音作りが楽しめます。
http://mpuusan.web.fc2.com/x68sound/x68soundbody.htm
よりX68Sound.dll本体をダウンロードして入手のうえ、展開された
X68Sound.dllを本ソフトウエアと同じディレクトリにコピーしてく
ださい。
ただし、実FM音源と異なる部分もあるようですのでご留意ください。
まずはX68Sound.dllのみで遊んでいただいて、興味を持たれたら実ハードウ
エアの導入を検討してみるのもよいかもしれません。
なおソフトウエアの性質上ディレイが生じます。これにより鍵盤を押すなど
の発音操作を行ってからワンテンポ遅れて発音されるため、若干動作が重い
ような印象を受けることになります(ご利用上の制限となります)。

●アプリケーションの起動方法
GIMIC、Re:BirthまたはFMの塔を接続し(電源を入れた状態で)、付属の
ToneEditor.exeを起動してください。

●操作方法
[FM Chip Type]
のドロップダウンメニューから、これから編集しようとするFM音源のチップを
選んでください。次の選択肢があります。

ONPA
OPM(4.00MHz)
OPM(3.58MHz)
OPL3(2OP)
OPL3(3OP)
OPLL
OPL
OPL2

OPMはご利用のOPMモジュールに入力されているクロックに合わせて選択して
ください。
GIMICは任意のクロックが設定可能なハードウエアとなっていますので、
どちらも選択可能です(選択した値にGIMICのOPMモジュールのクロック値を
変更します)。

・各音源の対応状況
GIMIC: OPNA,OPM,OPL3モジュールが使用できます。
RE:birth: OPNA,OPM,OPLL,OPL,OPL2モジュールが使用できます(OPL3は未確認)。
FMの塔: OPNA,OPMが使用できます。


[Channel]
どのチャンネルから音を出すかを指定します。
OPNAでは 0-5 、OPMでは 0-7などが指定可能です。通常は 0 のままで問題ありません。

[CON]
ConnectionまたはAlgorithm と呼ばれるパラメータを入力します。
"CON"や "AL" という表記になっている数値が該当します。
入力した数値により、左の絵が変わります。

[FB]
Feedback と呼ばれるパラメータを入力します。

[FREQ](OPNA)
LFO FREQの値を入力します。
値は0-15まで入力可能ですが、【有効となるのは8-15の値が入力された時】となります。
紙面等に掲載された音色値を入力するときで本欄の表記がない場合は 0 にしてください。

[SPD](OPM)
SPEED(LFRQ)の値を入力します。
紙面等に掲載された音色値を入力するときで本欄の表記がない場合は 0 にしてください。

[PMS][AMS]
紙面等に掲載された音色値を入力するときで本欄の表記がない場合は 0 にしてください。

[AR]...
AR DR  SR  RR SL  TL KS MUL DT  n/a AME
AR D1R D2R RR D1L TL RS MUL DT1 DT2 AME

FM音源の各パラメータを入力します。OPN系とOPM系で(同等の目的のパラメータで
であっても)名前が異なるので、マニュアルに準じた名称になっています。
ただし、音源データの書籍等では混在していたりするので適宜読み替えてください。

"AR"の文字列の上にマウスカーソルを置くと、ポップアップでフルスペルを
表示します。
また、入力フィールド上にマウスカーソルを置くと MAX:15 などとポップアップ
します。これによりこのフィールどは 0-15 の値が入力可能であることがわかる
ようになっています。

これらのフィールドでは 0〜9 の数字キー以外の入力は特別な意味を持ちます。
[Enter]キーを入力することで、後述の[音色を設定]ボタンを押したのと同様の処理が可能です。
また、キーボード ZXCVB...の行、およびその上の行の一部のキーの入力は、
後述の[鍵盤]と同様の意味を持ちます。
また[↑][↓]キーでその値を増減させることが可能です。
つまり、あるパラメータをちょっと変更してみてその音を確かめたいときは、
(0)そのフィールドにフォーカスを設定し、
(1)"0"-"9"キーのみで数値を入力するか、[↑][↓]キーで値を増減させ、
(2)[Enter]キーでFM音源チップに音色を設定し、
(3)"C","V","B"...等と入力して音を確認
(4)気に入らなければ BS キーで削除して (1)へ
などのようにキーボードのみで音色の確認を行うことが可能になっています。
入力フィールド間の移動はWindows標準の操作方法である
-[TAB]で次の入力フィールドへ
-{SHIFT]+[TAB]で前の入力フィールドへ
移動すれば、マウスに触れること無く一連の手順を行うことができます。
左手をホームポジションでCやVを押せるように配置、右手をカーソルキー(+Enter)
あるいはテンキー、あるいはNumLockを外したテンキー等の配置で

なお、例えばDT2はOPM系にしかないパラメータであるため、OPNAを選択した
場合は入力できないようになっています。グレーアウトしている部分は、
選択されたFM音源チップでは入力できない(参照されない)データになります。


[音色を設定]
このボタンを押すことで、入力されたデータを実FM音源チップに設定します。
設定の前に、値として許される範囲に収まっているかを確認します。範囲外
の場合はカーソルがそこに移動します(音色はFM音源チップには設定されま
せん)。

[鍵盤]
[音色を設定した]後にマウスカーソルをおき、左ボタンを押すと
[Channel]で指定したチャンネルから音を出します。
FM音源の Key-On ,Key-Off は左ボタンの押し下げ状態により対応しています
ので、「押しっぱなしにする」なども楽しめます。
キーボードのZXCの最下段およびその上の段により、疑似鍵盤として対応して
います【同時押しは対応していません！】。
"C"キーが"ド(C)"に対応しています。

●ファイル入出力機能
[ファイル][開く]
にて、拡張子 .FTN のファイルを音色データとして読み込むことが可能です。
読み込む時点では値のチェックは行いません(読み込むだけであり、[音色を設定]
ボタンを押さなければFM音源チップに音色は反映されません)
.FTNファイル形式はシンプルな 11 * 5 バイトのベタなバイナリファイルです。

[ファイル][名前を付けて保存]
にて、該当音色をファイルとして保存可能です。


●編集機能
[編集][コピー]
にて、音色をいわゆるCSV形式(10進数)でクリップボードにコピーします。
メモ帳やテキストエディタで"貼り付け"することで簡単にデータを取り込めます

[編集][貼り付け]
【***デバッグ未完了により動作しません***】
クリップボード上にコピーされたCSV形式の音色データを読み込みます。
設定するだけであり、FM音源チップには反映されません([音色を設定]ボタンを
押して反映させてください)。

●本ソフトウエアの構成について
ToneEditor.exe :
 Visual Basic 2013 のみで作成されています。
 NetGSELF.dllを参照しています。
NetGSELF.dll :
 C++/CLIで作成されています。
 GSELF.dllを.NET Framework上から制御できるようにしたwrapperです。
GSELF.dll : 
 C++で作成されています。C86CTL.dll、SCCI.dll 及び X68Sound.dll を参照し、
 統合されたAPIを提供します。


●補足事項
・既存のデータについて
本ソフトウエアは参考文献の「パソコンFM音源音色ライブラリー Vol.1 」などに
記載された音色データを、ほぼそのまま入力できるようになっていますので活用
してみてください。
また、X68000版グラディウスIIのマニュアルには音色データが記載してあったり、
またネット上に音色データを公開している方々もいらっしゃいます。
それらはほぼ本ソフトウエアに似た形式で公開されていますので、有効に利用さ
せてもらいましょう！


・疑似SRとは
OPL系のFM音源チップには、SRパラメータが存在しません。
しかしながら、Key-Off時にSLの値をSRであるかのように使用することが確認
されています。
そこで、Key-Off直前にSRとして用意された値を設定することで、OPN/OPM系の
SRを表現可能であることが判明しました。

本ソフトウエアでは、これに対応しています。この「擬似的なSR」を「疑似SR」
と表現しています。
疑似SRを使用するときは、右端の疑似SRのチェックボックスをチェック[レ]し、
pSR(pseudo SRの意)に疑似SR値を設定してください。

疑似SRを使用するとき、(0,4) の未使用データ領域をフラグとして使用します
((0,4)をキー入力で編集することはできません)。
作成された音色データの使用時に参照してください。
bit 0: 1でOP1は疑似SRを使用
bit 1: 1でOP2は疑似SRを使用
bit 2: 1でOP3は疑似SRを使用(OPL3 4OP時)
bit 3: 1でOP4は疑似SRを使用(OPL3 4OP時)


・OPLL選択時の特例
OPLLは特異なFM音源チップとなっており、
-「内蔵音色」を有する
-OPLのサブセットのような音色を1種類だけユーザー定義
 -アルゴリズムは変更できない(直列一種類のみ)
 -OP2にTLパラメータが無い
 -ETC
などの他のFM音源チップには特徴的な機能となっています。
本ソフトウエアの作者が「内蔵音色も試してみたい(鳴らしてみたい)」と考えた
ことから、(音色エディタとしての機能から外れますが)内蔵の音色も発音可能と
なっています。
INST フィールド(他の音源はCONの位置)に設定する値により、設定した音色か
あるいは内蔵音源かを選ぶようになっています。

0    ->音色データが有効
1-15 ->内蔵音色が選択され音色データは無効(無視されます)

●参考文献/サイト
試験にでるX1 祝一平
PC-9800シリーズ FM音源スーパーサウンド 窪田弘/田中寿朗/広瀬真
パソコンFM音源音色ライブラリー Vol.1 原田雅司/長田秀哉
ヤマハ 各種FM音源サウンドチップマニュアル
DOBON.NET : http://dobon.net/ ;VB2013による実装で大いに参考にさせていただきました

●Special Thanks(順不同)
餓死3-san : SCCI/FMの塔、操作方法ほか
魔土災炎-san : 疑似SRやOPL系
UME-3-san : 各種パラメータ範囲
hex125 aka 293-san : 操作系

・変更履歴
2015/06/23 [↑][↓]キー操作
2015/06/21 DT1の範囲(OPNA/OPM),AMSの範囲(OPNA)修正
           SPEED(OMP),LFEQ追加
2015/06/19 初期リリース
